{% extends "base.html" %}
{% block title %}Rate & Review{% endblock %}
{% block content %}
<div class="container">
  <h1>{{ book[1] }}</h1>
  <p><strong>Author:</strong> {{ book[2] }}</p>
  <p><strong>Genres:</strong> {{ book[3] }}</p>
  <p><strong>Rating:</strong> {{ book[4] }}</p>
  <p><strong>ISBN:</strong> {{ book[5] }}</p>

  <hr>

  {% if session.get('user_id') %}
    <h3>📝 Your Review</h3>
    <form method="POST" action="{{ url_for('submit_review') }}">
      <input type="hidden" name="book_id" value="{{ book[0] }}">
      
      <label for="rating">⭐ Rating:</label>
      <select name="rating" required>
        {% for i in range(1, 6) %}
          <option value="{{ i }}" {% if review and review ['rating'] == i %}selected{% endif %}>{{ i }}</option>
        {% endfor %}
      </select><br><br>

      <label for="review">💬 Review:</label><br>
      <textarea name="review" rows="4" cols="50" required>{{ review['review'] if review else '' }}</textarea><br><br>

      <button type="submit">💾 {{ 'Update Review' if review else 'Submit Review' }}</button>
    </form>

    {% if review %}
    <form method="POST" action="{{ url_for('delete_review') }}">
      <input type="hidden" name="book_id" value="{{ book[0] }}">
      <button type="submit" style="margin-top: 10px; background-color: crimson;">🗑️ Delete Review</button>
    </form>
    {% endif %}
  {% else %}
    <p><a href="/login">Login</a> to leave a review!</p>
  {% endif %}
</div>
{% endblock %}
